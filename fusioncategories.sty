%%
%% This is file `fusioncategories.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% fusioncategories.dtx  (with options: `fusioncategories')
%% 
%% --------------------------------------------------------------------------------
%% fusioncategories --- A package for fusion category data
%% --------------------------------------------------------------------------------
%% jcbridgeman1@gmail.com
%% https://jcbridgeman.github.io
%% Released under the MIT License
%% See http://www.latex-project.org/lppl.txt
%% --------------------------------------------------------------------------------
%% 

\ProvidesExplPackage{fusioncategories}{2024-07-28}{0.1.0}{A package for fusion category data}

\RequirePackage{expl3}[2022-01-10]

\IfPackageAtLeastTF{expl3}{2022-01-10}{}{
\msg_error:nn { fusioncategories } { expl3~version~too~old.~ (Minimum~supported:~2022-01-10) }
}

\RequirePackage{etoolbox}
\RequirePackage{xcolor}
\RequirePackage{amsmath}
\definecolor{nightBlue}{RGB}{27,81,166}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% fusioncategories PACKAGE OPTIONS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\prop_gput:Nnn \g_msg_module_type_prop { fusioncategories } { Package }

\msg_new:nnn { fusioncategories }{ unknown_option }{ Unknown~key:~\l_keys_key_str.~ }
\msg_new:nnn { fusioncategories }{ unknown_option_value }%
{ Unknown~choice~'#1'~for~option~'#2'. Valid~choices~are~{#3}.~ }

\tl_new:N \l__fusioncategories_delimiter_tl
\tl_set:Nn \l__fusioncategories_delimiter_tl { , }

\keys_define:nn { fusioncategories }
{
delimiter .value_required:n = true,
delimiter .initial:n = { , },
delimiter .code:n = { \tl_if_blank:nTF {#1} { \tl_set:Nn \l__fusioncategories_delimiter_tl { , } } { \tl_set:Nn \l__fusioncategories_delimiter_tl {#1} } },
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ProcessKeyOptions [ fusioncategories ]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NewDocumentCommand{\CreateSymbol}{ m m m m m }
{
\__fusioncategories_createsymbol:nnnnn { #1 } { #2 } { #3 } { #4 } { #5 }
}

\seq_new:N \l__fusioncategories_subscripts_seq
\seq_new:N \l__fusioncategories_superscripts_seq
\seq_new:N \l__fusioncategories_leftindices_seq
\seq_new:N \l__fusioncategories_rightindices_seq

\NewDocumentEnvironment { xsmallmatrix } { O{ 0.01ex } } {\renewcommand\thickspace{\kern#1}\smallmatrix}{\endsmallmatrix}

\tl_new:N \l__fusioncategories_left_tl
\tl_new:N \l__fusioncategories_middle_tl
\tl_new:N \l__fusioncategories_right_tl

\cs_generate_variant:Nn \seq_set_split:Nnn { NVn }

\cs_if_exist:NF \int_if_zero:nF {
\cs_new:Npn \int_if_zero:nF #1 #2 { \int_compare:nNnF {#1} = { 0 } {#2} }
}

\cs_new_protected:Npn \__fusioncategories_catsymbol:nnnnnn #1 #2 #3 #4 #5 #6 {

\seq_clear:N \l__fusioncategories_subscripts_seq
\seq_clear:N \l__fusioncategories_superscripts_seq
\seq_clear:N \l__fusioncategories_leftindices_seq
\seq_clear:N \l__fusioncategories_rightindices_seq

\tl_if_blank:nF { #3 }{
\seq_set_split:NVn \l__fusioncategories_subscripts_seq \l__fusioncategories_delimiter_tl { #3 }
}

\tl_if_blank:nF { #4 }{
\seq_set_split:NVn \l__fusioncategories_superscripts_seq \l__fusioncategories_delimiter_tl { #4 }
}

\tl_if_blank:nF { #5 }{
\seq_set_split:NVn \l__fusioncategories_leftindices_seq \l__fusioncategories_delimiter_tl { #5 }
}

\tl_if_blank:nF { #6 }{
\seq_set_split:NVn \l__fusioncategories_rightindices_seq \l__fusioncategories_delimiter_tl { #6 }
}

\int_set:Nn \l_tmpa_int { \seq_count:N \l__fusioncategories_leftindices_seq }
\int_set:Nn \l_tmpb_int { \seq_count:N \l__fusioncategories_rightindices_seq }

\hbox_set:Nn \l_tmpa_box {  }

\tl_clear:N \l__fusioncategories_left_tl
\tl_clear:N \l__fusioncategories_middle_tl
\tl_clear:N \l__fusioncategories_right_tl

\tl_put_right:Nn \l__fusioncategories_left_tl {
\int_if_zero:nF { \l_tmpa_int } {
\begin{xsmallmatrix}
\seq_item:Nn \l__fusioncategories_leftindices_seq {3} \\
\seq_item:Nn \l__fusioncategories_leftindices_seq {2} \\
\seq_item:Nn \l__fusioncategories_leftindices_seq {1}
\end{xsmallmatrix}\!\!
}
 }

\tl_put_right:Nn \l__fusioncategories_middle_tl {
\IfBooleanT { #2 }{ \cs:w overline \cs_end: \c_group_begin_token }
#1
\sb{\seq_use:Nn \l__fusioncategories_subscripts_seq {}}
\sp{ \seq_use:Nn \l__fusioncategories_superscripts_seq {}}
\IfBooleanT { #2 }{ \c_group_end_token }
 }

\tl_put_right:Nn \l__fusioncategories_right_tl {
\int_if_zero:nF { \l_tmpb_int } {
\!\!
\begin{xsmallmatrix}
\seq_item:Nn \l__fusioncategories_rightindices_seq {3} \\
\seq_item:Nn \l__fusioncategories_rightindices_seq {2} \\
\seq_item:Nn \l__fusioncategories_rightindices_seq {1}
\end{xsmallmatrix}
}
}

\hbox_set:Nn \l_tmpa_box { \ensuremath{\tl_use:N \l__fusioncategories_left_tl} }
\dim_set:Nn \l_tmpa_dim { \box_ht:N \l_tmpa_box }

\hbox_set:Nn \l_tmpa_box { \ensuremath{\tl_use:N \l__fusioncategories_right_tl} }
\dim_set:Nn \l_tmpb_dim { \box_ht:N \l_tmpa_box }

\dim_set:Nn \l_tmpa_dim { \dim_max:nn { \l_tmpa_dim } { \l_tmpb_dim } }

\hbox_set:Nn \l_tmpa_box { \ensuremath{\tl_use:N \l__fusioncategories_middle_tl} }
\dim_set:Nn \l_tmpb_dim { \box_ht:N \l_tmpa_box }

\dim_set:Nn \l_tmpa_dim { \dim_max:nn { \l_tmpa_dim } { \l_tmpb_dim } }

\int_if_zero:nF {\l_tmpa_int + \l_tmpb_int } {
\tl_put_left:Nn \l__fusioncategories_middle_tl { \left[\rule{ 0pt }{ \dim_eval:n { 1.05 \l_tmpa_dim } } }
\tl_put_right:Nn \l__fusioncategories_middle_tl { \right]}
\tl_put_left:Nn \l__fusioncategories_middle_tl { \l__fusioncategories_left_tl }
\tl_put_right:Nn \l__fusioncategories_middle_tl { \l__fusioncategories_right_tl }
}

\ensuremath{\tl_use:N \l__fusioncategories_middle_tl}
}

\seq_new:N \l__fusioncategories_command_seq
\tl_new:N \l__fusioncategories_argspec_tl

\cs_new:Npn \__fusioncategories_addtosequence:NVn #1#2#3{

\str_set:Nn \l_tmpa_str { #3 }
\str_remove_all:Nn \l_tmpa_str { ~ }

\bool_if:nTF { \str_if_eq_p:Vn \l_tmpa_str { false } || \str_if_eq_p:Vn \l_tmpa_str { 0 } || \tl_if_blank_p:n { #3 } }
{
\seq_put_right:Nx #1 { }
}
{
\seq_put_right:Nx \l__fusioncategories_command_seq { ####\int_use:N #2 }
\int_incr:N #2
}
}

\cs_new:Npn \__fusioncategories_createsymbol:nnnnn #1 #2 #3 #4 #5
{
\seq_set_from_clist:Nn \l_tmpa_seq { #2, #3, #4, #5 }
\tl_set:Nx \l__fusioncategories_argspec_tl { \prg_replicate:nn { \seq_count:N \l_tmpa_seq } { m~ } }

\int_set:Nn \l_tmpa_int { 2 }

\seq_clear:N \l__fusioncategories_command_seq

\__fusioncategories_addtosequence:NVn \l__fusioncategories_command_seq \l_tmpa_int { #2 }
\__fusioncategories_addtosequence:NVn \l__fusioncategories_command_seq \l_tmpa_int { #3 }
\__fusioncategories_addtosequence:NVn \l__fusioncategories_command_seq \l_tmpa_int { #4 }
\__fusioncategories_addtosequence:NVn \l__fusioncategories_command_seq \l_tmpa_int { #5 }

\tl_set:Nx \l_tmpa_tl {
\exp_not:N \DeclareDocumentCommand { \exp_not:c { #1Symbol } } { ~s~\l__fusioncategories_argspec_tl }
{
 \exp_not:c {__fusioncategories_catsymbol:nnnnnn}{#1}{ ####1 }{ \seq_item:Nn \l__fusioncategories_command_seq {1} }{ \seq_item:Nn \l__fusioncategories_command_seq {2} }{ \seq_item:Nn \l__fusioncategories_command_seq {3} }{ \seq_item:Nn \l__fusioncategories_command_seq {4} } } }

\tl_use:N \l_tmpa_tl
}
\__fusioncategories_createsymbol:nnnnn { N }{ true }{ true }{  }{  }
\__fusioncategories_createsymbol:nnnnn { X }{ true }{ true }{  }{ true }
\__fusioncategories_createsymbol:nnnnn { F }{ true }{ true }{ true }{ true }
\__fusioncategories_createsymbol:nnnnn { R }{ true }{ true }{ true }{ true }

\cs_new_eq:NN \F \FSymbol

%% 
%% --------------------------------------------------------------------------------
%% Copyright (C) 2024 Jacob C. Bridgeman <jcbridgeman1@gmail.com>
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3 of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%% http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3c or later is part of all distributions of
%% LaTeX version 2008-05-04 or later.
%% 
%% This work consists of the file  fusioncategories.dtx
%% and the derived files:
%% fusioncategories.ins, fusioncategories.sty
%% --------------------------------------------------------------------------------
%%
%% End of file `fusioncategories.sty'.
